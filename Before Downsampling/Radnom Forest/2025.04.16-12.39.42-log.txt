SPARK_CONF_DIR: /home/xb56574/is789sp25_user/project/spark-job-21491728-4-nodes-2025.04.16-12.39.42/spark-conf
master:cnode002
slaves: cnode003
cnode004
cnode006
starting org.apache.spark.deploy.master.Master, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.master.Master-1-cnode002.out
cnode004: starting org.apache.spark.deploy.worker.Worker, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.worker.Worker-1-cnode004.out
cnode006: starting org.apache.spark.deploy.worker.Worker, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.worker.Worker-1-cnode006.out
cnode003: starting org.apache.spark.deploy.worker.Worker, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.worker.Worker-1-cnode003.out
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
|1st_Road_Class|1st_Road_Number|2nd_Road_Number|Accident_Severity|Day_of_Week|Junction_Control|Junction_Detail| Latitude|Light_Conditions|Location_Easting_OSGR|Location_Northing_OSGR|Longitude|Number_of_Casualties|Number_of_Vehicles|Road_Surface_Conditions|Road_Type|Speed_limit|Urban_or_Rural_Area|Weather_Conditions|Year|InScotland|Accident_Hour|Accident_Minute|Day|Month|Season|
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
|             2|          450.0|            0.0|                0|          2|               1|              1|51.520075|               1|             524170.0|              181650.0|-0.211708|                   1|                 1|                      0|        0|       30.0|                  0|                 0|2005|         1|           17|             36|  5|    1|     0|
|             2|            0.0|            0.0|                0|          3|               0|              0|51.512695|               1|             524220.0|              180830.0|-0.211277|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           20|             40| 13|    1|     0|
|             0|         3212.0|          304.0|                0|          5|               1|              1| 51.48342|               1|             527350.0|              177650.0|-0.167342|                   2|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           22|             43| 15|    1|     0|
|             2|          450.0|            0.0|                0|          5|               0|              0|51.512443|               0|             524550.0|              180810.0|-0.206531|                   5|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           16|              0| 15|    1|     0|
|             0|            4.0|          325.0|                0|          6|               1|              1|51.494902|               1|             526240.0|              178900.0|-0.182872|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2005|         1|            0|             42| 16|    1|     0|
|             0|         3220.0|          308.0|                0|          1|               1|              1|51.484044|               1|             526170.0|              177690.0|-0.184312|                   1|                 2|                      1|        1|       30.0|                  0|                 0|2005|         1|           20|             48| 25|    1|     0|
|             1|            0.0|         3220.0|                0|          1|               0|              0|51.491632|               0|             525590.0|              178520.0|-0.192366|                   1|                 1|                      1|        3|       30.0|                  0|                 1|2005|         1|           12|             55| 11|    1|     0|
|             0|         3217.0|         3216.0|                0|          1|               0|              0|51.492622|               1|             527990.0|              178690.0|-0.157753|                   1|                 2|                      1|        3|       30.0|                  0|                 1|2005|         1|            5|              1| 18|    1|     0|
|             0|         3217.0|            0.0|                0|          1|               0|              0|51.481912|               0|             526460.0|              177460.0| -0.18022|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2005|         1|           10|             50| 18|    1|     0|
|             1|            0.0|            0.0|                1|          3|               0|              0|51.500191|               1|             524680.0|              179450.0|-0.205139|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|            0|             15| 20|    1|     0|
|             0|         3218.0|            4.0|                0|          4|               0|              0|51.495811|               0|             527000.0|              179020.0|-0.171887|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|            9|             15| 21|    1|     0|
|             0|            4.0|            0.0|                1|          5|               0|              0|51.495498|               1|             526790.0|              178980.0|-0.174925|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2005|         1|            3|              0|  8|    1|     0|
|             2|          415.0|            0.0|                0|          0|               0|              0|51.513039|               1|             524700.0|              180880.0|-0.204346|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           17|              5| 24|    1|     0|
|             0|         3220.0|         3220.0|                0|          0|               1|              1|51.482076|               1|             526930.0|              177490.0|-0.173445|                   1|                 2|                      1|        0|       30.0|                  0|                 0|2005|         1|           21|             30| 24|    1|     0|
|             2|            0.0|            0.0|                0|          1|               0|              1| 51.49296|               1|             527290.0|              178710.0|-0.167824|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           17|             25| 18|    1|     0|
|             0|            4.0|          319.0|                0|          5|               1|              0|51.498062|               0|             527380.0|              179280.0|-0.166322|                   1|                 2|                      1|        0|       30.0|                  0|                 0|2005|         1|            7|             34| 29|    1|     0|
|             2|            0.0|            0.0|                0|          2|               0|              0|51.508265|               1|             523930.0|              180330.0|-0.215629|                   1|                 1|                      1|        1|       30.0|                  0|                 1|2005|         1|           16|             35| 19|    1|     0|
|             0|         3220.0|         3218.0|                0|          5|               1|              1|51.488671|               0|             525570.0|              178190.0|-0.192771|                   2|                 2|                      1|        1|       30.0|                  0|                 1|2005|         1|           13|             15| 29|    1|     0|
|             0|            4.0|            0.0|                0|          1|               1|              1|51.494902|               1|             526240.0|              178900.0|-0.182872|                   1|                 2|                      1|        0|       30.0|                  0|                 1|2005|         1|           18|             20|  1|    2|     0|
|             2|          319.0|            0.0|                0|          2|               0|              0|51.496893|               1|             527780.0|              179160.0|-0.160606|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|            7|             25|  2|    2|     0|
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
only showing top 20 rows

root
 |-- 1st_Road_Class: integer (nullable = true)
 |-- 1st_Road_Number: double (nullable = true)
 |-- 2nd_Road_Number: double (nullable = true)
 |-- Accident_Severity: integer (nullable = true)
 |-- Day_of_Week: integer (nullable = true)
 |-- Junction_Control: integer (nullable = true)
 |-- Junction_Detail: integer (nullable = true)
 |-- Latitude: double (nullable = true)
 |-- Light_Conditions: integer (nullable = true)
 |-- Location_Easting_OSGR: double (nullable = true)
 |-- Location_Northing_OSGR: double (nullable = true)
 |-- Longitude: double (nullable = true)
 |-- Number_of_Casualties: integer (nullable = true)
 |-- Number_of_Vehicles: integer (nullable = true)
 |-- Road_Surface_Conditions: integer (nullable = true)
 |-- Road_Type: integer (nullable = true)
 |-- Speed_limit: double (nullable = true)
 |-- Urban_or_Rural_Area: integer (nullable = true)
 |-- Weather_Conditions: integer (nullable = true)
 |-- Year: integer (nullable = true)
 |-- InScotland: integer (nullable = true)
 |-- Accident_Hour: integer (nullable = true)
 |-- Accident_Minute: integer (nullable = true)
 |-- Day: integer (nullable = true)
 |-- Month: integer (nullable = true)
 |-- Season: integer (nullable = true)
 |-- attributes: vector (nullable = true)

Test Accuracy:  0.8638846423130275
/umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/python/lib/pyspark.zip/pyspark/sql/context.py:158: FutureWarning: Deprecated in 3.0.0. Use SparkSession.builder.getOrCreate() instead.
Precision:  0.7462966752243075
Recall:  0.8638846423130275
F1 Score:  0.800797064670456
Confusion Matrix:
 [[329445.      0.]
 [ 51908.      0.]]
/umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3//bin/spark-submit --master spark://cnode002:7077 --driver-memory 40g --executor-memory 10g --total-executor-cores 16 --executor-cores 6 /umbc/rs/is789sp25/users/xb56574/project/rfc1.py
cnode004: stopping org.apache.spark.deploy.worker.Worker
cnode006: stopping org.apache.spark.deploy.worker.Worker
cnode003: stopping org.apache.spark.deploy.worker.Worker
stopping org.apache.spark.deploy.master.Master

SPARK_CONF_DIR: /home/xb56574/is789sp25_user/project/spark-job-21492449-3-nodes-2025.05.12-13.02.43/spark-conf
master:cnode002
slaves: cnode003
cnode004
starting org.apache.spark.deploy.master.Master, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.master.Master-1-cnode002.out
cnode004: starting org.apache.spark.deploy.worker.Worker, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.worker.Worker-1-cnode004.out
cnode003: starting org.apache.spark.deploy.worker.Worker, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.worker.Worker-1-cnode003.out
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
|1st_Road_Class|1st_Road_Number|2nd_Road_Number|Accident_Severity|Day_of_Week|Junction_Control|Junction_Detail| Latitude|Light_Conditions|Location_Easting_OSGR|Location_Northing_OSGR|Longitude|Number_of_Casualties|Number_of_Vehicles|Road_Surface_Conditions|Road_Type|Speed_limit|Urban_or_Rural_Area|Weather_Conditions|Year|InScotland|Accident_Hour|Accident_Minute|Day|Month|Season|
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
|             2|          450.0|            0.0|                0|          2|               1|              1|51.520075|               1|             524170.0|              181650.0|-0.211708|                   1|                 1|                      0|        0|       30.0|                  0|                 0|2005|         1|           17|             36|  5|    1|     0|
|             2|            0.0|            0.0|                0|          3|               0|              0|51.512695|               1|             524220.0|              180830.0|-0.211277|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           20|             40| 13|    1|     0|
|             0|         3212.0|          304.0|                0|          5|               1|              1| 51.48342|               1|             527350.0|              177650.0|-0.167342|                   2|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           22|             43| 15|    1|     0|
|             2|          450.0|            0.0|                0|          5|               0|              0|51.512443|               0|             524550.0|              180810.0|-0.206531|                   5|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           16|              0| 15|    1|     0|
|             0|            4.0|          325.0|                0|          6|               1|              1|51.494902|               1|             526240.0|              178900.0|-0.182872|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2005|         1|            0|             42| 16|    1|     0|
|             0|         3220.0|          308.0|                0|          1|               1|              1|51.484044|               1|             526170.0|              177690.0|-0.184312|                   1|                 2|                      1|        1|       30.0|                  0|                 0|2005|         1|           20|             48| 25|    1|     0|
|             1|            0.0|         3220.0|                0|          1|               0|              0|51.491632|               0|             525590.0|              178520.0|-0.192366|                   1|                 1|                      1|        3|       30.0|                  0|                 1|2005|         1|           12|             55| 11|    1|     0|
|             0|         3217.0|         3216.0|                0|          1|               0|              0|51.492622|               1|             527990.0|              178690.0|-0.157753|                   1|                 2|                      1|        3|       30.0|                  0|                 1|2005|         1|            5|              1| 18|    1|     0|
|             0|         3217.0|            0.0|                0|          1|               0|              0|51.481912|               0|             526460.0|              177460.0| -0.18022|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2005|         1|           10|             50| 18|    1|     0|
|             1|            0.0|            0.0|                1|          3|               0|              0|51.500191|               1|             524680.0|              179450.0|-0.205139|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|            0|             15| 20|    1|     0|
|             0|         3218.0|            4.0|                0|          4|               0|              0|51.495811|               0|             527000.0|              179020.0|-0.171887|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|            9|             15| 21|    1|     0|
|             0|            4.0|            0.0|                1|          5|               0|              0|51.495498|               1|             526790.0|              178980.0|-0.174925|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2005|         1|            3|              0|  8|    1|     0|
|             2|          415.0|            0.0|                0|          0|               0|              0|51.513039|               1|             524700.0|              180880.0|-0.204346|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           17|              5| 24|    1|     0|
|             0|         3220.0|         3220.0|                0|          0|               1|              1|51.482076|               1|             526930.0|              177490.0|-0.173445|                   1|                 2|                      1|        0|       30.0|                  0|                 0|2005|         1|           21|             30| 24|    1|     0|
|             2|            0.0|            0.0|                0|          1|               0|              1| 51.49296|               1|             527290.0|              178710.0|-0.167824|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|           17|             25| 18|    1|     0|
|             0|            4.0|          319.0|                0|          5|               1|              0|51.498062|               0|             527380.0|              179280.0|-0.166322|                   1|                 2|                      1|        0|       30.0|                  0|                 0|2005|         1|            7|             34| 29|    1|     0|
|             2|            0.0|            0.0|                0|          2|               0|              0|51.508265|               1|             523930.0|              180330.0|-0.215629|                   1|                 1|                      1|        1|       30.0|                  0|                 1|2005|         1|           16|             35| 19|    1|     0|
|             0|         3220.0|         3218.0|                0|          5|               1|              1|51.488671|               0|             525570.0|              178190.0|-0.192771|                   2|                 2|                      1|        1|       30.0|                  0|                 1|2005|         1|           13|             15| 29|    1|     0|
|             0|            4.0|            0.0|                0|          1|               1|              1|51.494902|               1|             526240.0|              178900.0|-0.182872|                   1|                 2|                      1|        0|       30.0|                  0|                 1|2005|         1|           18|             20|  1|    2|     0|
|             2|          319.0|            0.0|                0|          2|               0|              0|51.496893|               1|             527780.0|              179160.0|-0.160606|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2005|         1|            7|             25|  2|    2|     0|
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
only showing top 20 rows

+-----------------+----------+----------------------------------------+
|Accident_Severity|prediction|probability                             |
+-----------------+----------+----------------------------------------+
|0                |0.0       |[0.9152676583316431,0.08473234166835686]|
|0                |0.0       |[0.8643803758847046,0.13561962411529538]|
|0                |0.0       |[0.8233129210821738,0.1766870789178262] |
|0                |0.0       |[0.8991561084124192,0.10084389158758078]|
|0                |0.0       |[0.9289107396452913,0.07108926035470875]|
|0                |0.0       |[0.896588135670967,0.10341186432903304] |
|0                |0.0       |[0.9241572054751748,0.07584279452482523]|
|0                |0.0       |[0.9228159428071966,0.07718405719280341]|
|0                |0.0       |[0.8994407645465212,0.10055923545347878]|
|0                |0.0       |[0.9329161860615635,0.06708381393843654]|
|0                |0.0       |[0.9273880188900477,0.07261198110995226]|
|0                |0.0       |[0.6145835773508501,0.3854164226491499] |
|0                |0.0       |[0.8978877398782978,0.10211226012170216]|
|0                |0.0       |[0.9159038622734798,0.08409613772652025]|
|0                |0.0       |[0.9167112706835934,0.08328872931640663]|
|0                |0.0       |[0.7895978572007027,0.21040214279929725]|
|0                |0.0       |[0.9081511045815477,0.09184889541845231]|
|0                |0.0       |[0.8660734687271551,0.13392653127284493]|
|0                |0.0       |[0.9077477684508836,0.09225223154911644]|
|0                |0.0       |[0.7649291416816723,0.23507085831832775]|
+-----------------+----------+----------------------------------------+
only showing top 20 rows

Test Accuracy:  0.8644180154119864
/umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/python/lib/pyspark.zip/pyspark/sql/context.py:158: FutureWarning: Deprecated in 3.0.0. Use SparkSession.builder.getOrCreate() instead.
Precision:  0.8133555478683338
Recall:  0.8644180154119864
F1 Score:  0.8051579705153578
Confusion Matrix:
 [[329206.    765.]
 [ 50980.    700.]]
/umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3//bin/spark-submit --master spark://cnode002:7077 --driver-memory 40g --executor-memory 14g --total-executor-cores 18 --executor-cores 3 /umbc/rs/is789sp25/users/xb56574/project/gbt-imbal.py
cnode004: stopping org.apache.spark.deploy.worker.Worker
cnode003: stopping org.apache.spark.deploy.worker.Worker
stopping org.apache.spark.deploy.master.Master

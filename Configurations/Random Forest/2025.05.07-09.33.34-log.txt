SPARK_CONF_DIR: /home/xb56574/is789sp25_user/project/spark-job-21492320-3-nodes-2025.05.07-09.33.34/spark-conf
master:cnode004
slaves: cnode006
cnode007
starting org.apache.spark.deploy.master.Master, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.master.Master-1-cnode004.out
cnode007: starting org.apache.spark.deploy.worker.Worker, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.worker.Worker-1-cnode007.out
cnode006: starting org.apache.spark.deploy.worker.Worker, logging to /umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/logs/spark-xb56574-org.apache.spark.deploy.worker.Worker-1-cnode006.out
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
|1st_Road_Class|1st_Road_Number|2nd_Road_Number|Accident_Severity|Day_of_Week|Junction_Control|Junction_Detail| Latitude|Light_Conditions|Location_Easting_OSGR|Location_Northing_OSGR|Longitude|Number_of_Casualties|Number_of_Vehicles|Road_Surface_Conditions|Road_Type|Speed_limit|Urban_or_Rural_Area|Weather_Conditions|Year|InScotland|Accident_Hour|Accident_Minute|Day|Month|Season|
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
|             0|         4168.0|            0.0|                0|          4|               0|              0|52.523475|               0|             394140.0|              291740.0|-2.087811|                   1|                 2|                      1|        1|       30.0|                  0|                 1|2005|         1|           15|              5|  1|    4|     1|
|             1|            0.0|            0.0|                0|          3|               0|              0|53.078677|               0|             370130.0|              353590.0|-2.447356|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2006|         1|            7|             47| 23|    3|     1|
|             2|         5053.0|            0.0|                0|          5|               0|              3|53.093967|               0|             405030.0|              355200.0|-1.926346|                   3|                 2|                      1|        1|       40.0|                  1|                 0|2011|         1|           13|             30| 25|    6|     2|
|             1|         8285.0|         8284.0|                1|          0|               0|              0|54.959048|               0|             409600.0|              562720.0|-1.851607|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2007|         1|           16|             10| 30|    7|     2|
|             1|            0.0|            0.0|                0|          6|               0|              2| 51.62072|               1|             559220.0|              193830.0| 0.298604|                   1|                 2|                      1|        2|       30.0|                  0|                 1|2005|         1|            7|             50| 11|   12|     0|
|             0|          530.0|            0.0|                1|          1|               0|              0|53.115954|               0|             368120.0|              357750.0|-2.477774|                   1|                 2|                      0|        1|       60.0|                  1|                 0|2012|         1|           11|              0|  2|   10|     3|
|             1|            0.0|            0.0|                1|          1|               0|              1|50.944346|               1|             276560.0|              117580.0|-3.758498|                   2|                 2|                      0|        1|       60.0|                  1|                 1|2010|         1|           23|             15| 16|   11|     3|
|             0|         4201.0|          406.0|                0|          1|               1|              0|51.512948|               0|             529110.0|              180980.0|-0.140791|                   1|                 1|                      1|        1|       30.0|                  0|                 1|2008|         1|           13|             33|  2|   12|     0|
|             0|          515.0|           36.0|                0|          4|               0|              0|52.881495|               0|             416690.0|              331590.0|-1.753439|                   2|                 2|                      0|        1|       60.0|                  1|                 0|2010|         1|           13|             10| 27|    8|     2|
|             0|          641.0|         6379.0|                0|          2|               0|              0|53.752076|               0|             415252.0|              428437.0|-1.770178|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2016|         1|           18|             27|  7|    9|     3|
|             1|            0.0|            0.0|                0|          2|               0|              0|51.520603|               0|             539260.0|              182100.0|  0.00583|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2010|         1|           14|             42| 11|    8|     2|
|             2|         1319.0|         9561.0|                0|          0|               0|              0|55.083707|               1|             426460.0|              576660.0| -1.58703|                   1|                 3|                      1|        1|       30.0|                  0|                 1|2007|         1|           19|             24| 19|    2|     0|
|             2|         4066.0|          326.0|                0|          5|               0|              2|51.690108|               0|             369040.0|              199140.0|-2.449305|                   1|                 2|                      1|        2|       30.0|                  1|                 1|2005|         1|           14|             30|  1|   10|     3|
|             0|           25.0|            0.0|                1|          6|               0|              0| 51.24141|               0|             520220.0|              150550.0| -0.27913|                   1|                 3|                      0|        1|       50.0|                  1|                 0|2010|         1|           14|             51| 28|    3|     1|
|             1|            0.0|            0.0|                1|          2|               0|              3|51.535296|               0|             523200.0|              183320.0|-0.225098|                   1|                 1|                      0|        1|       30.0|                  0|                 0|2007|         1|           17|             48| 25|    4|     1|
|             2|         6179.0|           88.0|                0|          2|               0|              1| 53.01961|               0|             438640.0|              347080.0|-1.425431|                   1|                 2|                      1|        1|       40.0|                  1|                 1|2007|         1|           15|             30| 24|    1|     0|
|             1|            0.0|            0.0|                0|          4|               0|              0|55.613169|               0|             349210.0|              635800.0|-2.807882|                   1|                 2|                      1|        1|       30.0|                  0|                 0|2005|         0|           16|              2| 18|    2|     0|
|             0|         1083.0|         1083.0|                0|          5|               0|              0|51.563042|               0|             546960.0|              187040.0| 0.118796|                   1|                 2|                      0|        1|       30.0|                  0|                 0|2011|         1|           11|             20| 23|    4|     1|
|             1|            0.0|         3354.0|                0|          5|               0|              0|50.964467|               0|             449420.0|              118580.0|-1.297638|                   2|                 2|                      1|        1|       30.0|                  0|                 1|2008|         1|           11|             20|  9|    8|     2|
|             0|         3057.0|           33.0|                0|          2|               1|              1| 50.90514|               0|             441130.0|              111910.0|-1.416434|                   1|                 2|                      0|        0|       30.0|                  0|                 0|2007|         1|           15|             18| 16|    5|     1|
+--------------+---------------+---------------+-----------------+-----------+----------------+---------------+---------+----------------+---------------------+----------------------+---------+--------------------+------------------+-----------------------+---------+-----------+-------------------+------------------+----+----------+-------------+---------------+---+-----+------+
only showing top 20 rows

root
 |-- 1st_Road_Class: integer (nullable = true)
 |-- 1st_Road_Number: double (nullable = true)
 |-- 2nd_Road_Number: double (nullable = true)
 |-- Accident_Severity: integer (nullable = true)
 |-- Day_of_Week: integer (nullable = true)
 |-- Junction_Control: integer (nullable = true)
 |-- Junction_Detail: integer (nullable = true)
 |-- Latitude: double (nullable = true)
 |-- Light_Conditions: integer (nullable = true)
 |-- Location_Easting_OSGR: double (nullable = true)
 |-- Location_Northing_OSGR: double (nullable = true)
 |-- Longitude: double (nullable = true)
 |-- Number_of_Casualties: integer (nullable = true)
 |-- Number_of_Vehicles: integer (nullable = true)
 |-- Road_Surface_Conditions: integer (nullable = true)
 |-- Road_Type: integer (nullable = true)
 |-- Speed_limit: double (nullable = true)
 |-- Urban_or_Rural_Area: integer (nullable = true)
 |-- Weather_Conditions: integer (nullable = true)
 |-- Year: integer (nullable = true)
 |-- InScotland: integer (nullable = true)
 |-- Accident_Hour: integer (nullable = true)
 |-- Accident_Minute: integer (nullable = true)
 |-- Day: integer (nullable = true)
 |-- Month: integer (nullable = true)
 |-- Season: integer (nullable = true)
 |-- attributes: vector (nullable = true)

Test Accuracy:  0.6838384947890082
/umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3/python/lib/pyspark.zip/pyspark/sql/context.py:158: FutureWarning: Deprecated in 3.0.0. Use SparkSession.builder.getOrCreate() instead.
Precision:  0.6614114774634495
Recall:  0.6838384947890082
F1 Score:  0.6104875171681093
Confusion Matrix:
 [[98677.  4720.]
 [44212.  7160.]]
/umbc/rs/is789sp25/common/software/spark-3.5.0-bin-hadoop3//bin/spark-submit --master spark://cnode004:7077 --driver-memory 40g --executor-memory 10g --total-executor-cores 9 --executor-cores 3 /umbc/rs/is789sp25/users/xb56574/project/rf-config.py
cnode007: stopping org.apache.spark.deploy.worker.Worker
cnode006: stopping org.apache.spark.deploy.worker.Worker
stopping org.apache.spark.deploy.master.Master
